Domino and Tromino Tiling
=========================

Jul 11, 2020 ¬∑ 6 min read

–ï—Å—Ç—å –¥–≤–∞ —Ç–∏–ø–∞ —Ñ–∏–≥—É—Ä: –¥–æ–º–∏–Ω–æ –∏ —Ç—Ä–∏–º–∏–Ω–æ (—Ç—Ä–µ—É–≥–æ–ª—å–Ω–æ–µ –¥–æ–º–∏–Ω–æ):

![](/images/domino-and-tromino-tiling--example.jpg)

–§–∏–≥—É—Ä—ã –º–æ–∂–Ω–æ –≤—Ä–∞—â–∞—Ç—å. –ó–∞–¥–∞—á–∞ ‚Äî –Ω–∞–π—Ç–∏ **—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤** –∑–∞–º–æ—Å—Ç–∏—Ç—å –≤—Å—é –¥–æ—Å–∫—É —Ä–∞–∑–º–µ—Ä–æ–º `2xN` —Ç–∞–∫, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏–ª–∞—Å—å –ø–ª–∏—Ç–∫–∞: –∫–∞–∂–¥—ã–π –∫–≤–∞–¥—Ä–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω. –û—Ç–≤–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –ø–æ –º–æ–¥—É–ª—é `10^9+7`.

–ï—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä `N` ‚Üí `[1, 1000]`.

[–ó–∞–¥–∞—á–∞ –Ω–∞ LeetCode](https://leetcode.com/problems/domino-and-tromino-tiling/).

–†–µ—à–µ–Ω–∏–µ¬†[#](#—Ä–µ—à–µ–Ω–∏–µ)
---------------------

–°–ø–µ—Ä–≤–∞ –Ω–∞–¥–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –∑–Ω–∞—á–∏—Ç ¬´—Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã¬ª: –ø–µ—Ä–≤–æ–µ, –æ —á—ë–º –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä–∞, –ø—Ä–∏–≤–µ—Å—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã –ø–æ–≤–æ—Ä–æ—Ç–æ–≤ –∏ —É—Ç–æ—á–Ω–∏—Ç—å –æ–Ω–∏ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∏–ª–∏ –Ω–µ—Ç.

–î–æ–ø—É—Å—Ç–∏–º –µ—Å—Ç—å —Ñ–∏–≥—É—Ä–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–∞—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ. –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–≤–µ—Ä–Ω—É—Ç—å –µ—ë —Å–ø–µ—Ä–≤–∞ –ø–æ —á–∞—Å–æ–≤–æ–π —Å—Ç—Ä–µ–ª–∫–µ, –ø–æ—Ç–æ–º –ø—Ä–æ—Ç–∏–≤.

![](/images/domino-and-tromino-tiling--rotate.jpg)

–ö–∞–∫ –≤–∏–¥–Ω–æ, –ø–æ–ª—É—á–∞–µ–º **—Ç–æ—Ç –∂–µ —Å–∞–º—ã–π –≤–∞—Ä–∏–∞–Ω—Ç**, –µ—Å–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å, —á—Ç–æ –≤—Å–µ –¥–æ–º–∏–Ω–æ –±–µ–∑ —Ç–æ—á–µ–∫, –≤—ã–≥–ª—è–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ç—Ä–∏–≤–∏–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏. –°–∫–æ–ª—å–∫–æ –µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è –¥–æ—Å–∫–∏ `2x1`? –¢–æ–ª—å–∫–æ **–æ–¥–∏–Ω** ‚Äî –ø–æ—Å—Ç–∞–≤–∏—Ç—å –æ–¥–Ω—É —Ñ–∏–≥—É—Ä—É –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ (–≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –Ω–µ –ø–æ–≤–µ—Ä–Ω—É—Ç—å, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —à–∏—Ä–∏–Ω—ã –¥–æ—Å–∫–∏).

–°–∫–æ–ª—å–∫–æ –¥–ª—è –¥–æ—Å–∫–∏ `2x2`? –ü–æ—Å—Ç–∞–≤–∏—Ç—å –¥–≤–µ —Ñ–∏–≥—É—Ä—ã –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –∏–ª–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ, —Ç.–µ. **–¥–≤–∞**. –ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å –ø–æ–≤–æ—Ä–æ—Ç–æ–º –æ–¥–Ω–æ–π —Ñ–∏–≥—É—Ä—ã, 4 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—Ä–∞—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ 2 _—Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞_.

–ò—Ç–∞–∫, –∏–¥—ë–º –¥–∞–ª—å—à–µ, –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –¥–ª—è `N=3` –Ω–∞—á–Ω—ë—Ç –≤—ã—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å—Å—è –∏ —Å–∞–º –∞–ª–≥–æ—Ä–∏—Ç–º.

![3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å –¥–æ–º–∏–Ω–æ](/images/domino-and-tromino-tiling--Neq3-domino.jpg) 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å –¥–æ–º–∏–Ω–æ.

![2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ —Å —Ç—Ä–∏–º–∏–Ω–æ](/images/domino-and-tromino-tiling--Neq3-trimino.jpg) –ò –µ—â—ë –¥–≤–∞ ‚Äî —Å —Ç—Ä–∏–º–∏–Ω–æ. –ò—Ç–æ–≥–æ, **5 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤**.

–ù–∞ —á—Ç–æ –ø–æ—Ö–æ–∂–∏ —ç—Ç–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å–æ —Å—Ç—Ä–µ–ª–æ—á–∫–∞–º–∏? –≠—Ç–æ –¥–µ—Ä–µ–≤–æ. –£–∑–µ–ª —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ—Å–∫–∏ –¥–ª—è –∫–∞–∫–æ–≥–æ-—Ç–æ —Å—Ç–æ–ª–±—Ü–∞ `N`, —Å–≤—è–∑—å ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ `N+1` —Ç–∞–∫, —á—Ç–æ–±—ã –≤—Å–µ –∫–ª–µ—Ç–∫–∏ –Ω–∞ `N`\-–º —Å—Ç–æ–ª–±—Ü–µ –æ–∫–∞–∑–∞–ª–∏—Å—å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏.

–ó–∞–¥–∞—á–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ –ø–æ–¥—Å—á—ë—Ç—É –ø—É—Ç–µ–π –æ—Ç –∫–æ—Ä–Ω—è –∫ –ª–∏—Å—Ç—å—è–º, —Ç.–µ. **–∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ª–∏—Å—Ç—å–µ–≤**.

–ö–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å? **–ü–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É**. –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä –≤—Å–µ—Ö —É–∑–ª–æ–≤ –æ—Ç –∫–æ—Ä–Ω—è, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –¥–æ—à–ª–∏ –¥–æ –ª–∏—Å—Ç–∞ ‚Äî —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫, –¥–∞–ª—å—à–µ –∏–¥—Ç–∏ –Ω–µ–∫—É–¥–∞, –±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π. –†–µ–∫—É—Ä—Å–∏—è –æ–±–æ–π–¥—ë—Ç –≤—Å–µ –¥–µ—Ä–µ–≤–æ.

–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–∏—Å–∞—Ç—å —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ —Å—Ç–æ–∏—Ç –æ—Ü–µ–Ω–∏—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏–Ω—Ç–µ—Ä–≤—å—é–µ—Ä —Å —ç—Ç–∏–º –æ–∫. –°–ª–æ–∂–Ω–æ—Å—Ç—å –ª–∏–Ω–µ–π–Ω–∞—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–∑–ª–æ–≤ –≤ –¥–µ—Ä–µ–≤–µ, –≤–æ–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–∫–æ–ª—å–∫–æ —ç—Ç–∏—Ö —É–∑–ª–æ–≤ –∏ –∫–∞–∫ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ–Ω—è–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ `N`. –°–ø–æ–π–ª–µ—Ä: –≤—Å—ë –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ.

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –ø–µ—Ä–≤—É—é –∫–æ–ª–æ–Ω–∫—É, –∏ –¥–∞–ª—å—à–µ –µ—Å—Ç—å –µ—â—ë 2 —Å–≤–æ–±–æ–¥–Ω—ã–µ. –¢–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å –æ–¥–Ω–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –∏–ª–∏ –¥–≤–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã—Ö –¥–æ–º–∏–Ω–æ, –∏–ª–∏ –æ–¥–Ω–æ —Ç—Ä–∏–º–∏–Ω–æ –≤ –¥–≤—É—Ö –ø–æ–≤–æ—Ä–æ—Ç–∞—Ö ‚Äî **4 –≤–∞—Ä–∏–∞–Ω—Ç–∞**:

![](/images/domino-and-tromino-tiling--transition.jpg)

–ê –µ—â—ë –º–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏ —Ç—Ä–∏–º–∏–Ω–æ, –∏ –¥–∞–ª—å—à–µ –µ—Å—Ç—å –µ—â—ë 2 —Å–≤–æ–±–æ–¥–Ω—ã–µ, —Ç–æ–≥–¥–∞ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Å–ª–µ–¥—É—é—â–∏–µ:

![](/images/domino-and-tromino-tiling--l-transition.jpg)

–ò —Ç–∞–∫ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ, –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ `N`. –ß—É–≤—Å—Ç–≤—É–µ—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã–π –≤–∑—Ä—ã–≤? –ü–æ–ª—É—á–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤ –≤ —ç—Ç–æ–º –¥–µ—Ä–µ–≤–µ –º–æ–∂–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∫–∞–∫ `O(4^N)`: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –±–æ–ª–µ–µ 4 –¥–µ—Ç–æ–∫ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–≤–Ω–µ.

–î–ª—è `N = 1000`, —Ç–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–∏ –≤ –∫–∞–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–µ —É–ª–æ–∂–∏—Ç—Å—è. –û–¥–Ω–∞–∫–æ, –≤—Å—ë —Ä–∞–≤–Ω–æ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –µ–≥–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∏ –ø–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

    /**
     * @param {number} N
     * @return {number}
     */
    var numTilings = function(N) {
      const mod = 1e9 + 7;
    
      // –§—É–Ω–∫—Ü–∏—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ä–µ–≤–∞,
      // –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–∫—É—â—É—é –∫–æ–ª–æ–Ω–∫—É –∏ –Ω–µ–∫–∏–π —Å—Ç–µ–π—Ç,
      // –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–ª–æ–Ω–∫–∏.
      // –í—Å–µ–≥–æ –µ—Å—Ç—å 4 —Å–æ—Å—Ç–æ—è–Ω–∏—è:
      // - 0 - –æ–±–µ –∫–ª–µ—Ç–∫–∏ –≤ –∫–æ–ª–æ–Ω–∫–µ —Å–≤–æ–±–æ–¥–Ω—ã
      // - 1 ‚Äî –≤–µ—Ä—Ö–Ω—è—è –∫–ª–µ—Ç–∫–∞ –≤ –∫–æ–ª–æ–Ω–∫–µ –∑–∞–Ω—è—Ç–∞, –Ω–∏–∂–Ω—è—è —Å–≤–æ–±–æ–¥–Ω–∞
      // - 2 ‚Äî –Ω–∏–∂–Ω—è—è –∫–ª–µ—Ç–∫–∞ –≤ –∫–æ–ª–æ–Ω–∫–µ –∑–∞–Ω—è—Ç–∞, –≤–µ—Ä—Ö–Ω—è—è —Å–≤–æ–±–æ–¥–Ω–∞
      function dfs(col, state) {
        // –û–ø–∏—Å—ã–≤–∞–µ–º 4 —É–≥–ª–∞ –æ—á–µ—Ä–µ–¥–Ω–æ–π —Å–µ–∫—Ü–∏–∏:
        // {l,r}               {t,b}
        //  ^ –ª–µ–≤—ã–π –∏–ª–∏ –ø—Ä–∞–≤—ã–π  ^ –≤–µ—Ä—Ö–Ω–∏–π –∏–ª–∏ –Ω–∏–∂–Ω–∏–π
        // lt, lb –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–Ω—è—Ç—ã –≤ —Å–ª–µ–¥—Å—Ç–≤–∏–∏ —Ç–æ–≥–æ
        // –∫–∞–∫ –º—ã –ø–æ–ª–æ–∂–∏–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ñ–∏–≥—É—Ä—ã
        const lt = !(state & 1);
        const lb = !(state & 2);
    
        // rt, rb –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–Ω—è—Ç—ã
        // —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –º—ã –¥–æ—à–ª–∏ –¥–æ –∫—Ä–∞—è –¥–æ—Å–∫–∏
        const rt = col + 1 <= N;
        const rb = col + 1 <= N;
    
        // –±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π ‚Üí —É—Å–ø–µ—à–Ω–æ –¥–æ—à–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞ –¥–æ—Å–∫–∏,
        // —Ç.–µ. –¥–æ –ª–∏—Å—Ç–∞ –¥–µ—Ä–µ–≤–∞, –Ω–∞–¥–æ –≤–µ—Ä–Ω—É—Ç—å –µ–¥–∏–Ω–∏—Ü—É,
        // ¬´–æ–¥–∏–Ω –≤–∞—Ä–∏–∞–Ω—Ç¬ª –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å—é –¥–æ—Å–∫—É
    
        // _ x
        // _ x <- –∫—Ä–∞–π –¥–æ—Å–∫–∏
        // ^
        // –ø–æ—Å–ª–µ–¥–Ω—è—è –∫–æ–ª–æ–Ω–∫–∞
        if (lt && lb && !rt && !rb) {
          return 1;
        }
    
        let result = 0;
    
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –≤ –¥—Ä—É–≥–∏–µ —É–∑–ª—ã –¥–µ—Ä–µ–≤–∞
        // —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ ¬´–ø–µ—Ä–µ—Ö–æ–¥ –≤–æ–∑–º–æ–∂–µ–Ω¬ª,
        // –ø–æ–º–Ω–∏–º, —á—Ç–æ –Ω–∞–¥–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Ç–∞–∫–æ–µ
        // —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —Ñ–∏–≥—É—Ä —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤.
        // –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ state –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ –≤—ã–∑–æ–≤–æ–≤:
        // —Å–ª–µ–¥–∏–º –∑–∞ –∫–ª–µ—Ç–∫–∞–º–∏ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–ª–æ–Ω–∫–∏,
        // –∫–∞–∫–∏–µ –æ–∫–∞–∂—É—Ç—Å—è –∑–∞–Ω—è—Ç—ã, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
        // –æ—Ç —Ç–æ–≥–æ –∫–∞–∫—É—é —Ñ–∏–≥—É—Ä—É –∏ —Å –∫–∞–∫–∏–º –ø–æ–≤–æ—Ä–æ—Ç–æ–º –∫–ª–∞–¥—ë–º
    
        // _ _
        // _ _
        // –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏ —Å–≤–æ–±–æ–¥–Ω—ã–µ
        if (lt && lb && rt && rb) {
          // —Å–º. –∫–∞—Ä—Ç–∏–Ω–∫—É –≤—ã—à–µ,
          // —è –Ω–∞—Ä–∏—Å–æ–≤–∞–ª —ç—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥—ã
          result += dfs(col + 1, 0);
          result += dfs(col + 1, 1);
          result += dfs(col + 1, 2);
          result += dfs(col + 2, 0);
        }
        // x _
        // _ _
        // –ª–µ–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª –∑–∞–Ω—è—Ç
        if (!lt && lb && rt && rb) {
          result += dfs(col + 1, 2);
          result += dfs(col + 2, 0);
        }
        // _ _
        // x _
        // –ª–µ–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª –∑–∞–Ω—è—Ç
        if (!lb && lt && rt && rb) {
          result += dfs(col + 1, 1);
          result += dfs(col + 2, 0);
        }
        return result % mod;
      }
    
      // –∑–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ö–æ–¥ –æ—Ç ¬´–∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞¬ª:
      // –∫–æ–≥–¥–∞ –µ—Å—Ç—å –æ–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ (col = 1) –∏ –æ–Ω–∞ –ø—É—Å—Ç–∞—è (—Å—Ç–µ–π—Ç = 0)
      return dfs(1, 0);
    };
    

–¢–µ–ø–µ—Ä—å –Ω–∞–¥–æ –ø–æ–Ω—è—Ç—å –≥–¥–µ —Å–æ–≤–µ—Ä—à–∞–µ—Ç—Å—è –ª–∏—à–Ω—è—è —Ä–∞–±–æ—Ç–∞.

–ï—Å–ª–∏ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã `(col, state)`, —Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∏–¥–Ω–æ, —á—Ç–æ –≤ —Ü–µ–ø–æ—á–∫–µ –≤—ã–∑–æ–≤–æ–≤ –ø–æ–ø–∞–¥–∞—é—Ç—Å—è –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –ø–∞—Ä—ã. –§—É–Ω–∫—Ü–∏—è –æ–±—Ö–æ–¥–∞ –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç —ç—Ç–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –ø–∞—Ä—ã –±—É–¥–µ—Ç –≤—Å–µ–≥–¥–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º, —Ç–æ —á—Ç–æ –Ω–∞–∑—ã–≤–∞—é—Ç ¬´—á–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è¬ª.

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, –≤ –Ω–∞—à–µ–º –¥–µ—Ä–µ–≤–µ –µ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–µ–≤—å—è-–∫–ª–æ–Ω—ã ‚Äî –≤ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö –¥–µ—Ä–µ–≤–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —É–∑–ª—ã, –Ω–∞—á–∏–Ω–∞—è —Å –∫–æ—Ç–æ—Ä—ã—Ö –≤—Å–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä—è—Ç—Å—è, —Ç.–µ. –¥–∞–¥—É—Ç —Ä–æ–≤–Ω–æ —Ç–∞–∫–æ–µ –∂–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ. –≠—Ç–æ –∏ –µ—Å—Ç—å –ª–∏—à–Ω—è—è —Ä–∞–±–æ—Ç–∞.

–ü–æ–º–æ–∂–µ—Ç **–º–µ–º–æ–∏–∑–∞—Ü–∏—è** ‚Äî –∑–∞–≤–æ–¥–∏–º –∫—ç—à –∫—É–¥–∞ –±—É–¥–µ–º –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ —á–∏—Ç–∞—Ç—å, –µ—Å–ª–∏ –≤–¥—Ä—É–≥ –≤—Å—Ç—Ä–µ—Ç–∏–ª–∞—Å—å —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø–∞—Ä–∞.

    /**
     * @param {number} N
     * @return {number}
     */
    var numTilings = function(N) {
       const mod = 1e9 + 7;
    +  const cache = new Array(N + 2).fill(0).map(
    +    () => new Array(3)
    +  );
       function dfs(col, state) {
    +    if (cache[col][state] !== undefined) {
    +      return cache[col][state];
    +    }
    
    //   ...
    
    +    cache[col][state] = result % mod;
    -    return result % mod;
    +    return cache[col][state];
       }
    
      // –∑–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ö–æ–¥ –æ—Ç ¬´–∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞¬ª:
      // –∫–æ–≥–¥–∞ –µ—Å—Ç—å –æ–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ (col = 1) –∏ –æ–Ω–∞ –ø—É—Å—Ç–∞—è (—Å—Ç–µ–π—Ç = 0)
      return dfs(1, 0);
    };
    

–ü—Ä–∏ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ –º—ã –Ω–µ —Å–º–æ–∂–µ–º –æ–±–æ–π—Ç–∏ —É–∑–ª–æ–≤ –±–æ–ª—å—à–µ, —á–µ–º –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø–∞—Ä `(col, state)`, —Ç.–µ. `3 * (N + 1)`. –û—Ç–ª–∏—á–Ω–æ, —Å–ª–æ–∂–Ω–æ—Å—Ç—å ‚Äî –ª–∏–Ω–µ–π–Ω–∞—è, `O(N)`. –ü–æ –≤—Ä–µ–º–µ–Ω–∏, –∏ –ø–æ –ø–∞–º—è—Ç–∏, —Ç.–∫. –ø—Ä–∏—à–ª–æ—Å—å –∑–∞–≤–µ—Å—Ç–∏ –∫—ç—à + —Å—Ç–µ–∫ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤.

–ù–∞ —ç—Ç–æ–º –º–µ—Å—Ç–µ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –∏–Ω—Ç–µ—Ä–≤—å—é —É—Å–ø–µ—à–Ω–æ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è. –û–¥–Ω–∞–∫–æ, —ç—Ç–∞ –∑–∞–¥–∞—á–∞ —Ö–æ—Ä–æ—à–∞ —Ç–µ–º, —á—Ç–æ –µ—Å—Ç—å —Ç.–Ω. ‚Äúbar raiser‚Äù ‚Äî –º–æ–∂–Ω–æ –ø–æ–¥–Ω—è—Ç—å –ø–ª–∞–Ω–æ—á–∫—É.

–¢–æ, —á—Ç–æ —è —Å–µ–π—á–∞—Å –Ω–∞–ø–∏—Å–∞–ª –µ—â—ë –Ω–∞–∑—ã–≤–∞—é—Ç _‚Äútop-down‚Äù –≤–∞—Ä–∏–∞–Ω—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è_, –∞ –µ—Å—Ç—å _‚Äúbottom-up‚Äù_. –ö–æ–≥–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ `K` –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ `K+1`. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∑–Ω–∞—è —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–±–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π), –º–æ–∂–Ω–æ –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ —É—Å–ª–æ–≤–∏–∏ `N`.

–ü–æ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª—É—á–∏—Ç—Å—è —Ç–∞–∫ –∂–µ –ª–∏–Ω–∏—è, –∞ –≤–æ—Ç –ø–æ –ø–∞–º—è—Ç–∏ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å `O(1)`. –ò–º–µ–Ω–Ω–æ —ç—Ç–æ –∏ –º–æ–≥—É—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç—å –Ω–∞–ø–∏—Å–∞—Ç—å. –í—Å—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã–≤–µ—Å—Ç–∏ —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ.

–ï—Å–ª–∏ –µ—Å—Ç—å –∂–µ–ª–∞–Ω–∏–µ —É–≤–∏–¥–µ—Ç—å —Ä–∞–∑–±–æ—Ä —Ç–∞–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è ‚Äî –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å, –Ω–∞–ø–∏—à—É –≤—Ç–æ—Ä—É—é —á–∞—Å—Ç—å –ø–æ—Å—Ç–∞.

![](/images/domino-and-tromino-tiling--timing.jpg)

UPD (16.07.2020) –°–ø–∞—Å–∏–±–æ [@d\_dudkevich](https://twitter.com/@d_dudkevich) –∑–∞ —Ç–æ, —á—Ç–æ —É–∫–∞–∑–∞–ª –Ω–∞ –æ—à–∏–±–∫—É –Ω–∞ –æ–¥–Ω–æ–π –∏–∑ —Å—Ö–µ–º. –°–º–µ–ª–æ –ø–∏—à–∏—Ç–µ –≤ —á–∞—Ç, –µ—Å–ª–∏ –∑–∞–º–µ—Ç–∏–ª–∏, —á—Ç–æ —á—Ç–æ-—Ç–æ –Ω–µ —Å—Ö–æ–¥–∏—Ç—Å—è :-)

PS. –û–±—Å—É–¥–∏—Ç—å –º–æ–∂–Ω–æ –≤ [—Ç–µ–ª–µ–≥—Ä–∞–º-—á–∞—Ç–µ](https://t.me/ctci_chat_ru) –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤. Welcome! ü§ó

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ [–º–æ–π —Ç–≤–∏—Ç–µ—Ä](https://twitter.com/vitkarpov) –∏–ª–∏ [–∫–∞–Ω–∞–ª –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ](https://t.me/coding_interviews), —á—Ç–æ–±—ã —É–∑–Ω–∞–≤–∞—Ç—å –æ –Ω–æ–≤—ã—Ö —Ä–∞–∑–±–æ—Ä–∞—Ö –∑–∞–¥–∞—á.