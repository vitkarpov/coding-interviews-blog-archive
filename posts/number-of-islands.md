Number of Islands
=================

Aug 24, 2020 ¬∑ 7 min read

–î–∞–Ω–æ –¥–≤—É–º–µ—Ä–Ω–æ–µ –ø–æ–ª–µ –∏–∑ –Ω—É–ª–µ–π –∏ –µ–¥–∏–Ω–∏—Ü, –≥–¥–µ `1` –æ–∑–Ω–∞—á–∞–µ—Ç —Å—É—à—É, –∞ `0` –≤–æ–¥—É. –ü—Ä–∏–ª–µ–≥–∞—é—â–∏–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–ª–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É –µ–¥–∏–Ω–∏—Ü—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç _–æ—Å—Ç—Ä–æ–≤_.

![](/images/number-of-islands--example.jpg)

–ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç—Ä–æ–≤–æ–≤.

–†–µ—à–µ–Ω–∏–µ¬†[#](#—Ä–µ—à–µ–Ω–∏–µ)
---------------------

–ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å [–∑–∞–¥–∞—á–µ–π –ø—Ä–æ –ø–æ–∏—Å–∫ —Å–ª–æ–≤](/posts/word-search.md) –ø–æ–ª–µ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –≥—Ä–∞—Ñ.

![](/images/number-of-islands--disjoint.jpg)

–ü–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ ¬´–æ—Å—Ç—Ä–æ–≤¬ª —ç—Ç–æ –≤–æ—Ç —Ç–∞–∫–æ–π –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —É—á–∞—Å—Ç–æ–∫, –∏–ª–∏ [_disjoint set_](https://en.wikipedia.org/wiki/Disjoint_sets).

–ï—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö **union-find –∏–ª–∏ disjoint-set**, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ç–∞–∫–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞: –¥–æ–±–∞–≤–ª—è—Ç—å, –º—ë—Ä–¥–∂–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫ –∫–∞–∫–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —ç–ª–µ–º–µ–Ω—Ç. –†–∞–∑–±–µ—Ä—ë–º –∫–∞–∫ –º–æ–∂–Ω–æ —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —á—É—Ç—å –ø–æ–∑–∂–µ.

–ê –ø–æ–∫–∞, –∫–∞–∫ –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å –ø–æ-–ø—Ä–æ—Å—Ç–æ–º—É, –±–µ–∑ –≤—Å—è–∫–æ–π —Ç–µ–æ—Ä–∏–∏ –≥—Ä–∞—Ñ–æ–≤?

### –ü–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É¬†[#](#–ø–æ–∏—Å–∫-–≤-–≥–ª—É–±–∏–Ω—É)

–ë–µ–∂–∏–º –ø–æ –ø–æ–ª—é. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –µ–¥–∏–Ω–∏—á–∫—É –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –ø–æ–ø–∞–ª–∏ –≤ –æ–¥–∏–Ω –∏–∑ –æ—Å—Ç—Ä–æ–≤–æ–≤. –ù–∞—á–Ω—ë–º –ø–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É, –æ–±—Ö–æ–¥—è –≤—Å–µ —É–∑–ª—ã –≤ –≥—Ä–∞—Ñ–µ, –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –∑–∞–±—ã–≤–∞—è –∑–∞—Ç–∏—Ä–∞—Ç—å —É–∂–µ –ø–æ—Å–µ—â—ë–Ω–Ω—ã–µ.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã ¬´–≤—ã–∫—É—Å–∏–º¬ª –∏–∑ –ø–æ–ª—è —Ü–µ–ª—ã–π –æ—Å—Ç—Ä–æ–≤ –æ–¥–Ω–æ–π —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–π. –û—Å—Ç–∞–Ω–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —É–≤–µ–ª–∏—á–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –æ—Å—Ç—Ä–æ–≤–æ–≤ –ø–æ—Å–ª–µ.

–°–ª–æ–∂–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è ‚Äî –ª–∏–Ω–µ–π–Ω–∞—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –º—ã –º–æ–∂–µ–º –ø–æ—Å–µ—Ç–∏—Ç—å –∫–∞–∂–¥—ã–π —É–∑–µ–ª –≥—Ä–∞—Ñ–∞ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –ø–æ—Å–ª–µ –º—ã –µ–≥–æ ¬´—É–¥–∞–ª—è–µ–º¬ª, –∞ —É–∑–ª–æ–≤ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ, —á–µ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ–ª—è.

    /**
     * @param {character[][]} grid
     * @return {number}
     */
    var numIslands = function(grid) {
      const h = grid.length;
    
      // –µ—Å–ª–∏ –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è —Ä–∞–≤–Ω–∞ –Ω—É–ª—é,
      // —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º, —á—Ç–æ –∏ –æ—Å—Ç—Ä–æ–≤–æ–≤
      // —Ç–∞–º —Ä–æ–≤–Ω–æ –Ω–æ–ª—å
      if (h === 0) {
        return 0;
      }
    
      const w = grid[0].length;
      let islands = 0;
    
      // –±–µ–∂–∏–º –ø–æ –≤—Å–µ–º—É –ø–æ–ª—é
      for (let y = 0; y < h; y++) {
        for (let x = 0; x < w; x++) {
          // –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ–º –Ω–∞—á–∞–ª–æ ¬´–æ—Å—Ç—Ä–æ–≤–∞¬ª
          if (grid[y][x] === "1") {
            // ¬´–≤—ã–∫—É—Å—ã–≤–∞–µ–º¬ª –µ–≥–æ —Ü–µ–ª–∏–∫–æ–º –∏–∑ –ø–æ–ª—è
            burnIsland(grid, w, h, y, x);
            // –ø–æ—Å–ª–µ —á–µ–≥–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º
            // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç—Ä–æ–≤–æ–≤ –Ω–∞ –æ–¥–∏–Ω
            islands++;
          }
        }
      }
      return islands;
    };
    
    /**
     * @param {character[][]} grid - –ø–æ–ª–µ
     * @param {number} w - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è
     * @param {number} h - –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è
     * @param {number} y - y-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ –Ω–∞ –ø–æ–ª–µ
     * @param {number} x - x-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ –Ω–∞ –ø–æ–ª–µ
     * @return {number}
     */
    function burnIsland(grid, w, h, y, x) {
      // ¬´–≤—ã–∫—É—Å—ã–≤–∞–µ–º¬ª –æ—á–µ—Ä–µ–¥–Ω—É—é
      // –µ–¥–∏–Ω–∏—á–∫—É –∏–∑ –æ—Å—Ç—Ä–æ–≤–∞
      grid[y][x] = "0";
    
      // –±–µ–∂–∏–º –ø–æ –≤—Å–µ–º —á–µ—Ç—ã—Ä—ë–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º
      // –ø—Ä–∏–ª–µ–≥–∞—é—â–∏–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
      for (let [dx, dy] of [[0, 1], [1, 0], [0, -1], [-1, 0]]) {
        const x1 = x + dx;
        const y1 = y + dy;
    
        // –µ—Å–ª–∏ —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª—è
        within(w, h, y1, x1) &&
          // –∏ –µ—Å–ª–∏ —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –æ—Å—Ç—Ä–æ–≤–∞
          grid[y1][x1] === "1" &&
          // –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ ¬´–≤—ã–∫—É—Å—ã–≤–∞—Ç—å¬ª
          burnIsland(grid, w, h, y1, x1);
      }
    }
    
    /**
     * @param {number} w - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è
     * @param {number} h - –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è
     * @param {number} y - y-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ –Ω–∞ –ø–æ–ª–µ
     * @param {number} x - x-–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ –Ω–∞ –ø–æ–ª–µ
     * @return {boolean}
     */
    function within(w, h, y, x) {
      return 0 <= x && x < w && 0 <= y && y < h;
    }
    

![](/images/number-of-islands--sol1.jpg)

Union-Find¬†[#](#union-find)
---------------------------

Union-Find ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

*   _union_ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–≤–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤ –æ–¥–Ω–æ
*   _find_ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞–ª –ª–∏ –¥–≤–∞ —É–∑–ª–∞ –æ–¥–Ω–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É

> –ü—Ä–æ union-find –ª—É—á—à–µ –≤—Å–µ—Ö —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—Ç –†–æ–±–µ—Ä—Ç –°–µ–¥–∂–≤–∏–∫ –≤ [–∫—É—Ä—Å–µ –Ω–∞ Coursera](https://www.coursera.org/learn/algorithms-part1) –≤ –¥–µ—Ç–∞–ª—è—Ö, –æ–¥–Ω–∞–∫–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å [—Ö–æ—Ä–æ—à–∏–π –æ—Ç–≤–µ—Ç –Ω–∞ Quora](https://www.quora.com/What-is-an-intuitive-explanation-of-union-find).

–ß—Ç–æ–±—ã —Ä–µ–ª–∏–∑–æ–≤–∞—Ç—å union-find –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ –∑–∞–≤–µ—Å—Ç–∏ –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω—ã —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª—è. –ö–∞–∂–¥—ã–π –≤–æ–∑–º–æ–∂–Ω—ã–π —É–∑–µ–ª –≤ –≥—Ä–∞—Ñ–µ –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ `n - 1`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ —Ç–∞–∫–æ–º –º–∞—Å—Å–∏–≤–µ.

–°–ø–µ—Ä–≤–∞ –ø–æ–¥—Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –µ–¥–∏–Ω–∏—Ü –Ω–∞ –ø–æ–ª–µ. –ü–æ—Å–ª–µ –ø—Ä–æ–±–µ–∂–∏–º –ø–æ –ø–æ–ª—é –µ—â—ë —Ä–∞–∑ –∏, –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∫–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞–µ–º –µ–¥–∏–Ω–∏—Ü—É, –±—É–¥–µ–º –¥—ë—Ä–≥–∞—Ç—å `union` –¥–ª—è –≤—Å–µ—Ö —Å–æ—Å–µ–¥–Ω–∏—Ö –µ–¥–∏–Ω–∏—Ü. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞, –∫–∞–∫ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ [–≤ –Ω–∞—á–∞–ª–µ](/posts/number-of-islands.md#%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5).

–ï—Å–ª–∏ —É–¥–∞–ª–æ—Å—å —Å–æ–µ–¥–∏–Ω–∏—Ç—å —É–∑–ª—ã (—Ç.–µ. –æ–Ω–∏ –µ—â—ë –Ω–µ –±—ã–ª–∏ —Å–≤—è–∑–∞–Ω—ã —Ä–∞–Ω–µ–µ) ‚Äî —É–º–µ–Ω—å—à–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü. –¢–æ, —á—Ç–æ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –∏—Ç–æ–≥–µ –∏ –µ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ¬´–æ—Å—Ç—Ä–æ–≤–æ–≤¬ª, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ç–µ –µ—Å—Ç—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —É–∑–µ–ª –∫–æ—Ç–æ—Ä—ã–π –æ–∫–∞–∂–µ—Ç—Å—è —Å–≤—è–∑–∞–Ω —Å–æ –≤—Å–µ–º–∏ —Å–æ—Å–µ–¥—è–º–∏ —Ä–∞–Ω–µ–µ (–∏ –∫–æ—Ç–æ—Ä—ã–π –º—ã, –≤ –∏—Ç–æ–≥–µ, –Ω–µ –æ—Ç–Ω–∏–º–µ–º –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞).

    /**
     * @param {character[][]} grid
     * @return {number}
     */
    var numIslands = function(grid) {
      const h = grid.length;
    
      // –µ—Å–ª–∏ –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è —Ä–∞–≤–Ω–∞ –Ω—É–ª—é,
      // —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º, —á—Ç–æ –∏ –æ—Å—Ç—Ä–æ–≤–æ–≤
      // —Ç–∞–º —Ä–æ–≤–Ω–æ –Ω–æ–ª—å
      if (h === 0) {
        return 0;
      }
    
      const w = grid[0].length;
      // –Ω–∞—Ö–æ–¥–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –µ–¥–∏–Ω–∏—Ü,
      // –≤ –∫–æ–Ω—Ü–µ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
      let islands = countAllOnes(grid, w, h);
      // –∑–¥–µ—Å—å –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å —Å–≤—è–∑–∏ –º–µ–∂–¥—É —É–∑–ª–∞–º–∏
      const store = initStore(w, h);
    
      // –±–µ–∂–∏–º –ø–æ –≤—Å–µ–º—É –ø–æ–ª—é
      for (let y = 0; y < h; y++) {
        for (let x = 0; x < w; x++) {
          // –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ–º –Ω–∞—á–∞–ª–æ ¬´–æ—Å—Ç—Ä–æ–≤–∞¬ª
          if (grid[y][x] === "1") {
            // –ø—Ä–æ–±—É–µ–º –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å—Å—è
            // —Å–æ –≤—Å–µ–º–∏ —Å–æ—Å–µ–¥—è–º–∏
            for (const [dx, dy] of [[0, 1], [1, 0], [0, -1], [-1, 0]]) {
              // union –≤–µ—Ä–Ω—ë—Ç true –µ—Å–ª–∏
              // –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ
              // –∏ –º–æ–∂–Ω–æ —É–º–µ–Ω—å—à–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü
              if (
                within(w, h, [x + dx, y + dy]) &&
                grid[y + dy][x + dx] === "1" &&
                union(w, h, store, [x, y], [x + dx, y + dy])
              ) {
                islands--;
              }
            }
          }
        }
      }
      return islands;
    };
    
    /**
     * @param {character[][]} grid
     * @param {number} w - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è
     * @param {number} h - –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è
     * @return {number}
     */
    function countAllOnes(grid, w, h) {
      let result = 0;
    
      for (let y = 0; y < h; y++) {
        for (let x = 0; x < w; x++) {
          if (grid[y][x] === "1") {
            result++;
          }
        }
      }
      return result;
    }
    
    /**
     * @param {number} w - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è
     * @param {number} h - –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è
     * @param {number[]} result
     */
    function initStore(w, h) {
      return new Array(w * h).fill(0).map((_, index) => index);
    }
    
    /**
     * @param {number} w - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è
     * @param {number} h - –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è
     * @param {number[]} store - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–≤—è–∑–µ–π
     * @param {number[]} p1 - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ—á–∫–∏ –Ω–∞ –ø–æ–ª–µ
     * @param {number[]} p2 - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–æ—Å–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏ –Ω–∞ –ø–æ–ª–µ
     */
    function union(w, h, store, p1, p2) {
      const id1 = getId(p1, w);
      const id2 = getId(p2, w);
      const root1 = find(store, id1);
      const root2 = find(store, id2);
      // –µ—Å–ª–∏ —É –Ω–∏—Ö –æ–±—â–∏–µ —Ä–æ–¥–∏—Ç–µ–ª–∏
      // —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ —É–∂–µ
      // –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –æ–¥–Ω–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É
      if (root1 === root2) {
        return false;
      }
      // –∏–Ω–∞—á–µ —É–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —É root2 –Ω–æ–≤—ã–π —Ä–æ–¥–∏—Ç–µ–ª—å:
      // —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º ¬´—Ü–µ–ø–ª—è–µ–º¬ª –≤—Å—ë –¥–µ—Ä–µ–≤–æ
      // —Å –∫–æ—Ä–Ω–µ–º –≤ root2 –∫ –¥–µ—Ä–µ–≤—É —Å –∫–æ—Ä–Ω–µ–º –≤ root1,
      // —Ñ–æ—Ä–º–∏—Ä—É—è disjoint set ‚Üí –Ω–∞—à –æ—Å—Ç—Ä–æ–≤
      store[root1] = root2;
      return true;
    }
    
    /**
     * @param {number[]} store - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–≤—è–∑–µ–π
     * @param {number} id - –∞–π–¥–∏—à–Ω–∏–∫ —É–∑–ª–∞
     */
    function find(store, id) {
      // —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –±–µ–∂–∏–º –ø–æ —Ä–æ–¥–∏—Ç–µ–ª—è–º,
      // –ø–æ–∫–∞ –Ω–µ –¥–æ–±–µ—Ä—ë–º—Å—è –¥–æ –∫–æ—Ä–Ω—è –¥–µ—Ä–µ–≤–∞
      if (store[id] !== id) {
        return find(store, store[id]);
      }
      return store[id];
    }
    
    /**
     * @param {number[]} p - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ –Ω–∞ –ø–æ–ª–µ
     * @param {number} w - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è
     */
    function getId(p, w) {
      // –∞–π–¥–∏—à–Ω–∏–∫ —É–∑–ª–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è
      // –∫–∞–∫ –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –æ—Ç –ª–µ–≤–æ–≥–æ
      // –≤–µ—Ä—Ö–Ω–µ–≥–æ —É–≥–ª–∞ –ø–æ–ª—è
      return p[1] * w + p[0];
    }
    
    /**
     * @param {number} w - —à–∏—Ä–∏–Ω–∞ –ø–æ–ª—è
     * @param {number} h - –≤—ã—Å–æ—Ç–∞ –ø–æ–ª—è
     * @param {number[]} p - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ç–æ—á–∫–∏ –Ω–∞ –ø–æ–ª–µ
     * @return {boolean}
     */
    function within(w, h, [x, y]) {
      return 0 <= x && x < w && 0 <= y && y < h;
    }
    

–ë—ã—Å—Ç—Ä–µ–µ –ª–∏ —ç—Ç–æ? –ù–µ—Ç. `union` —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ –ª–∏–Ω–µ–π–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª—è. –î–ª—è –∫–∞–∂–¥–æ–π –µ–¥–∏–Ω–∏—á–∫–∏ –º—ã –¥—ë—Ä–≥–∞–µ–º `union`. –ü–æ–ª—É—á–∞–µ–º `O(N^2)`, –≥–¥–µ `N = w * h`.

![](/images/number-of-islands--sol2.jpg)

> –ú–æ–∂–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å `find` –∏ –∫–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏—è `union` —Å –ø–æ–º–æ—â—å—é [–∫–æ–º–ø—Ä–µ—Å—Å–∏–∏ –ø—É—Ç–µ–π](https://en.wikipedia.org/wiki/Disjoint-set_data_structure#Path_compression), –ø–æ –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø—Ä—ã–≥–∞—Ç—å `find` –ø—Ä–∏ –ø–æ–∏—Å–∫–µ.

–ó–∞—á–µ–º –∂–µ —Ç–æ–≥–¥–∞ –ø–∏—Å–∞—Ç—å union-find? –í–æ-–ø–µ—Ä–≤—ã—Ö, —ç—Ç–æ –∫—Ä–∞—Å–∏–≤–æ üôÇ

–ê –µ—â—ë —ç—Ç–æ —Ö–æ—Ä–æ—à–∞—è –∑–∞–¥–∞—á–∞, —á—Ç–æ–±—ã –ø–æ—â—É–ø–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º. –ü–æ—Ç–æ–º—É —á—Ç–æ –µ—Å—Ç—å –∫–∞–∑–∞–ª–æ—Å—å –±—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –∑–∞–¥–∞—á–∞ [surrounded regions](https://leetcode.com/problems/surrounded-regions/), –Ω–æ –∫–æ—Ç–æ—Ä–∞—è —Ö–æ—Ä–æ—à–æ —Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ union-find –∏ —Å–ª–æ–∂–Ω–µ–µ —á–µ—Ä–µ–∑ –ø–æ–∏—Å–∫ –≤ –≥–ª—É–±–∏–Ω—É.

PS. –û–±—Å—É–¥–∏—Ç—å –º–æ–∂–Ω–æ –≤ [—Ç–µ–ª–µ–≥—Ä–∞–º-—á–∞—Ç–µ](https://t.me/ctci_chat_ru) –ª—é–±–æ–∑–Ω–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤. Welcome! ü§ó

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –Ω–∞ [–º–æ–π —Ç–≤–∏—Ç–µ—Ä](https://twitter.com/vitkarpov) –∏–ª–∏ [–∫–∞–Ω–∞–ª –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–µ](https://t.me/coding_interviews), —á—Ç–æ–±—ã —É–∑–Ω–∞–≤–∞—Ç—å –æ –Ω–æ–≤—ã—Ö —Ä–∞–∑–±–æ—Ä–∞—Ö –∑–∞–¥–∞—á.